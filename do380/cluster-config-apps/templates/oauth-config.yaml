apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: "oauth-config-{{ .Values.targetEnv | lower}}"
  namespace: argocd
spec:
  destination:
    server: 'https://kubernetes.default.svc'
    namespace: {{ .Values.namespace }}
  project: {{ .Values.argocdProject }}
  source:
    path: "{{ .Values.targetEnv }}/oauth-config"
    repoURL: "{{ .Values.repoUrl }}"
    targetRevision: HEAD
  {{- if .Values.autoSync }}
  syncPolicy:
      automated: 
          prune: true
  {{- end }}